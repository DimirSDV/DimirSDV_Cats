# Задача 5 Поиск одинаковых товаров на маркетплейсе  

Финальный вариант проекта команды Cats DS для хакатона ЛИДЕРЫ ЦИФРОВОЙ ТРАНСФОРМАЦИИ 2023  

## Постановка задачи  

В ходе хакатона необходимо было разработать ML-модель, способную определить идентичность товаров по названиям, атрибутам и изображениям.  
Модель должна находить среди пар-кандидатов как можно больше одинаковых товаров с точностью >75%  

## Метрика  
Precision-Recall-AUC (Precision = 75%) усреднённый по крупным категориям.  

Всего в выборке представлено 4 уровня категорий. 1 уровень — самый общий. 2 — более глубокий (Автотовары, Электроника и другие). В рамках соревнования рассматривали только категорию Электроника и её подкатегории (категории 3 и 4 уровня). Примеры категорий 3 уровня в Электронике: Компьютер, Смарт-часы, Смартфоны и другие. Так как рассматривали только одну категорию 2 уровня, усреднять метрику стали по категориям 3 уровня. Крупные категории 3 уровня для обучающей выборки можно получить следующим образом:

train["cat3"] = train["categories"].apply(lambda x: json.loads(x)["3"]) 
train["cat3_grouped"] = train["cat3"].apply(lambda x: x if cat3_counts[x] > 1000 else "rest")
categories — можно достать из train_data.parquet и test_data.parquet.  
cat3_grouped — большие категории 3 уровня, по которым будет усредняться метрика (по сути, объединяем все категории с менее чем 1к примерами в обучающей выборке в одну категорию). 

## Установка  

Для корректной работы скрипта понадобится установить  

- pip  
- jupiter  
- pandas  
- seaborn  
- scikit-lern
- matplotlib  
- pyarrow
- functools
- json
- catboost
- scipy  
- nltk  
- tqdm  

## Документация  

Основные этапы работы отражены в презентации к проекту. Технические тонкости представлены в документации. 
Презентация и документация расположены в директории с моделью.  

## Данные  

Корпорация OZON предоставила для исследования выборку по части товаров в виде файлов в форматах .parquet и .csv:  

- train_pairs.parquet - тренировочная выборка с таргетом;  
- train_data.parquet - дополнительные данные для тренировочной выборки;  
- test_pairs_wo_target.parquet - тестовая выборка для участников без таргета;  
- test_data.parquet - дополнительные данные для тестовой выборки;  
- submission_example.csv - сабмит на бейзлайн.  

Для предсказания пар сходных товаров были предоставлены:  

- Тренировочная выборка: пары одинаковых и различных товаров;  
- Тестовая выборка: пары товаров без разметки (выборка для формирования лидерборда);  
- Дополнительные данные: названия, атрибуты, векторные представления картинок (эмбединги) товаров.  

Описание колонок из таблиц *_data.parquet:  

- variantid (int) уникальный id товара;  
- name (string) название товара;  
- categories (string) категории товара. Превратить в dict можно с помощью json.loads;  
- color_parsed (array`) цвета, которые удалось получить из атрибутов товара и названия простым способом;  
- embeddings - векторные представления товаров. Получены с помощью resnet50 и Bert;  
- characteristic_attributes_mapping (string) атрибуты товаров. Превратить в dict можно с помощью json.loads.  

Данные защищены NDA  

Авторы: команда Cats DS

Имя и фамилия	Роль (функции)
Иван Черных	DS / проджект
Толстова Ольга	Аналитик / DS
Степан Кутькин	Аналитик / DS
Егор Геращенко	Аналитик / документация
Дмитрий Саханенко 	Капитан / презентация


[Certificate.pdf](https://github.com/DimirSDV/DimirSDV_Cats/files/11880089/Certificate.pdf)


